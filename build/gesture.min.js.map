{"version":3,"sources":["gesture.js"],"names":["global","factory","exports","module","define","amd","self","GestureJs","this","classCallCheck","instance","Constructor","TypeError","createClass","protoProps","staticProps","defineProperties","prototype","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","DomElement","value","obj","selector","undefined","tagName","toUpperCase","matches","parentNode","ABS","Math","abs","Gesture","e","_this","point","touches","now","Date","touch","startX","pageX","startY","pageY","starTime","longTapTimeout","clearTimeout","tapTimeout","doubleTap","_emit","setTimeout","preventDefault","pretouch","time","startTime","console","log","type","handles","currentTarget","isTarget","params","len","callback","push","movetouch","zoom","deltaX","deltaY","diffX","diffY","angle","direction","HTMLElement","document","querySelector","Error","_init","addEventListener","_touch","bind","_move","_end","_cancel","ex","style","createElement","innerHTML","getElementsByTagName","item","appendChild","window"],"mappings":"CAAC,SAAUA,EAAQC,GACE,iBAAZC,SAA0C,oBAAXC,OAAyBA,OAAOD,QAAUD,IAC9D,mBAAXG,QAAyBA,OAAOC,IAAMD,OAAOH,IACnDD,EAASA,GAAUM,MAAaC,UAAYN,IAH/C,CAIEO,KAAM,WAAe,aAEA,SAAjBC,EAA2BC,EAAUC,GACvC,KAAMD,aAAoBC,GACxB,MAAM,IAAIC,UAAU,qCAFxB,IAMIC,EAWK,SAAUF,EAAaG,EAAYC,GAGxC,OAFID,GAAYE,EAAiBL,EAAYM,UAAWH,GACpDC,GAAaC,EAAiBL,EAAaI,GACxCJ,GAbT,SAASK,EAAiBE,EAAQC,GAChC,IAAK,IAAIC,EAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CACrC,IAAIE,EAAaH,EAAMC,GACvBE,EAAWC,WAAaD,EAAWC,aAAc,EACjDD,EAAWE,cAAe,EACtB,UAAWF,IAAYA,EAAWG,UAAW,GACjDC,OAAOC,eAAeT,EAAQI,EAAWM,IAAKN,IAYpD,IAAIO,GAKAhB,EAAYgB,EAAY,CAAC,CACrBD,IAAK,WACLE,MAAO,SAAkBC,EAAKC,GAC1B,KAAcC,MAAPF,GAA2B,MAAPA,GAA4C,QAA7BA,EAAIG,QAAQC,eAAyB,CAC3E,GAAIJ,EAAIK,QAAQJ,GACZ,OAAOD,EAEXA,EAAMA,EAAIM,WAEd,OAAO,SAGRR,GAhBP,SAASA,EAAWG,GAChBvB,EAAeD,KAAMqB,GAyB7B,IAAIS,EAAMC,KAAKC,IAEXC,GAwBA5B,EAAY4B,EAAS,CAAC,CAClBb,IAAK,SACLE,MAAO,SAAgBY,GACnB,IAAIC,EAAQnC,KAEZA,KAAKkC,EAAIA,EAAExB,OACX,IAAI0B,EAAQF,EAAEG,QAAUH,EAAEG,QAAQ,GAAKH,EACnCI,EAAMC,KAAKD,MAGftC,KAAKwC,MAAMC,OAASL,EAAMM,MAC1B1C,KAAKwC,MAAMG,OAASP,EAAMQ,MAC1B5C,KAAKwC,MAAMK,SAAWP,EAGtBtC,KAAK8C,gBAAkBC,aAAa/C,KAAK8C,gBACzC9C,KAAKgD,YAAcD,aAAa/C,KAAKgD,YACrChD,KAAKiD,WAAY,EACjBjD,KAAKkD,MAAM,QAAShB,GACG,EAAnBA,EAAEG,QAAQxB,SACVb,KAAK8C,eAAiBK,WAAW,WAC7BhB,EAAMe,MAAM,WACZf,EAAMc,WAAY,EAClBf,EAAEkB,kBACH,KACHpD,KAAKiD,UAAYjD,KAAKqD,SAASC,MAAQhB,EAAMtC,KAAKqD,SAASC,KAAO,KAAOxB,EAAI9B,KAAKwC,MAAMC,OAASzC,KAAKqD,SAASZ,QAAU,IAAMX,EAAI9B,KAAKwC,MAAMG,OAAS3C,KAAKqD,SAASV,QAAU,IAAMb,EAAI9B,KAAKwC,MAAMe,UAAYvD,KAAKqD,SAASC,MAAQ,IACtOtD,KAAKqD,SAAW,CACZZ,OAAQzC,KAAKwC,MAAMC,OACnBE,OAAQ3C,KAAKwC,MAAMG,OACnBW,KAAMtD,KAAKwC,MAAMe,cAI9B,CACCnC,IAAK,QACLE,MAAO,cACR,CACCF,IAAK,OACLE,MAAO,WACHtB,KAAK8C,gBAAkBC,aAAa/C,KAAK8C,kBAE9C,CACC1B,IAAK,UACLE,MAAO,WACHkC,QAAQC,IAAI,YAEjB,CACCrC,IAAK,QACLE,MAAO,SAAeoC,EAAMxB,GACvBlC,KAAK2D,QAAQD,KAAU1D,KAAK2D,QAAQD,GAAQ,IAC7C,IAhFDlC,EAgFKoC,EA/EL,IAAIvC,EAAWG,GA+EUqC,SAAS7D,KAAKkC,EAAGlC,KAAKwB,UAC9C,GAAIoC,IAAkB5D,KAAKwB,SAAU,CACjCxB,KAAKwB,WAAaxB,KAAK8D,OAAOtC,SAAWoC,GACzC,IAAK,IAAIhD,EAAI,EAAGmD,EAAM/D,KAAK2D,QAAQD,GAAM7C,OAAQD,EAAImD,EAAKnD,IACrB,mBAA1BZ,KAAK2D,QAAQD,GAAM9C,IAAqBZ,KAAK2D,QAAQD,GAAM9C,GAAGsB,EAAGlC,KAAK8D,QAGrF,OAAO,IAEZ,CACC1C,IAAK,KACLE,MAAO,SAAYoC,EAAMM,GAGrB,OAFChE,KAAK2D,QAAQD,KAAU1D,KAAK2D,QAAQD,GAAQ,IAC7C1D,KAAK2D,QAAQD,GAAMO,KAAKD,GACjBhE,OAEZ,CACCoB,IAAK,QACLE,MAAO,WACHtB,KAAKwC,MAAQ,GACbxC,KAAKkE,UAAY,GACjBlE,KAAK8D,OAAS,CAAEK,KAAM,EAAGC,OAAQ,EAAGC,OAAQ,EAAGC,MAAO,EAAGC,MAAO,EAAGC,MAAO,EAAGC,UAAW,QAGzFxC,GAjGP,SAASA,EAAQvB,EAAQc,GAIrB,GAHAvB,EAAeD,KAAMiC,GAErBjC,KAAKU,OAASA,aAAkBgE,YAAchE,EAA2B,iBAAXA,EAAsBiE,SAASC,cAAclE,GAAU,MAChHV,KAAKU,OACN,MAAM,IAAImE,MAAM,UACX7E,KAAK8E,QACd9E,KAAKwB,SAAWA,EAChBxB,KAAKU,OAAOqE,iBAAiB,aAAc/E,KAAKgF,OAAOC,KAAKjF,OAAO,GACnEA,KAAKU,OAAOqE,iBAAiB,YAAa/E,KAAKkF,MAAMD,KAAKjF,OAAO,GACjEA,KAAKU,OAAOqE,iBAAiB,WAAY/E,KAAKmF,KAAKF,KAAKjF,OAAO,GAC/DA,KAAKU,OAAOqE,iBAAiB,cAAe/E,KAAKoF,QAAQH,KAAKjF,OAAO,GAErEA,KAAK8D,OAAS,GACd9D,KAAKwC,MAAQ,GACbxC,KAAKkE,UAAY,GACjBlE,KAAKqD,SAAW,GAChBrD,KAAK8C,eAAiB,KACtB9C,KAAKgD,WAAa,KAClBhD,KAAKiD,WAAY,EACjBjD,KAAK2D,QAAU,GAgFvB,IACIgB,SACF,MAAOU,GACL,MAAM,IAAIR,MAAM,cAGpB,IACIS,EAAQX,SAASY,cAAc,SAOnC,OANAD,EAAM5B,KAAO,WACb4B,EAAME,UAHU,wJAIhBb,SAASc,qBAAqB,QAAQC,KAAK,GAAGC,YAAYL,GAE5CM,OAAO3D,SAAWA","file":"gesture.min.js","sourcesContent":["(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = global || self, global.GestureJs = factory());\n}(this, (function () { 'use strict';\n\n  var classCallCheck = function (instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  };\n\n  var createClass = function () {\n    function defineProperties(target, props) {\n      for (var i = 0; i < props.length; i++) {\n        var descriptor = props[i];\n        descriptor.enumerable = descriptor.enumerable || false;\n        descriptor.configurable = true;\n        if (\"value\" in descriptor) descriptor.writable = true;\n        Object.defineProperty(target, descriptor.key, descriptor);\n      }\n    }\n\n    return function (Constructor, protoProps, staticProps) {\n      if (protoProps) defineProperties(Constructor.prototype, protoProps);\n      if (staticProps) defineProperties(Constructor, staticProps);\n      return Constructor;\n    };\n  }();\n\n  // 创建对象\n  var DomElement = function () {\n      function DomElement(selector) {\n          classCallCheck(this, DomElement);\n      }\n\n      createClass(DomElement, [{\n          key: 'isTarget',\n          value: function isTarget(obj, selector) {\n              while (obj != undefined && obj != null && obj.tagName.toUpperCase() != 'BODY') {\n                  if (obj.matches(selector)) {\n                      return obj;\n                  }\n                  obj = obj.parentNode;\n              }\n              return null;\n          }\n      }]);\n      return DomElement;\n  }();\n\n  // new一个对象\n\n\n  function $(selector) {\n      return new DomElement(selector);\n  }\n\n  var ABS = Math.abs;\n\n  var Gesture = function () {\n      function Gesture(target, selector) {\n          classCallCheck(this, Gesture);\n\n          this.target = target instanceof HTMLElement ? target : typeof target === 'string' ? document.querySelector(target) : null;\n          if (!this.target) {\n              throw new Error('请绑定元素!');\n          }        this._init();\n          this.selector = selector;\n          this.target.addEventListener('touchstart', this._touch.bind(this), false);\n          this.target.addEventListener('touchmove', this._move.bind(this), false);\n          this.target.addEventListener('touchend', this._end.bind(this), false);\n          this.target.addEventListener('touchcancel', this._cancel.bind(this), false);\n\n          this.params = {};\n          this.touch = {}; //记录刚触摸的手指\n          this.movetouch = {}; //记录移动过程中变化的手指参数\n          this.pretouch = {}; //由于会触及到双击, 需要一个记录上一次触摸的对象\n          this.longTapTimeout = null; //用于触发长按的定时器\n          this.tapTimeout = null; //用于触发点击的定时器\n          this.doubleTap = false; //用于记录是否执行双击的定时器\n          this.handles = {}; //用于存放回调函数的对象\n      }\n\n      createClass(Gesture, [{\n          key: '_touch',\n          value: function _touch(e) {\n              var _this = this;\n\n              this.e = e.target;\n              var point = e.touches ? e.touches[0] : e;\n              var now = Date.now();\n\n              // 记录手指位置等参数\n              this.touch.startX = point.pageX;\n              this.touch.startY = point.pageY;\n              this.touch.starTime = now;\n\n              // 由于会有多次触摸的情况, 单击事件和双击针对单次触摸 故先清空定时器\n              this.longTapTimeout && clearTimeout(this.longTapTimeout);\n              this.tapTimeout && clearTimeout(this.tapTimeout);\n              this.doubleTap = false;\n              this._emit('touch', e); //执行原生的touchstart回调 _emit为执行的方法 后面定义\n              if (e.touches.length > 1) ; else {\n                  this.longTapTimeout = setTimeout(function () {\n                      _this._emit('longtap'); //执行长按回调\n                      _this.doubleTap = false;\n                      e.preventDefault();\n                  }, 800);\n                  this.doubleTap = this.pretouch.time && now - this.pretouch.time < 300 && ABS(this.touch.startX - this.pretouch.startX) < 30 && ABS(this.touch.startY - this.pretouch.startY) < 30 && ABS(this.touch.startTime - this.pretouch.time) < 300;\n                  this.pretouch = {\n                      startX: this.touch.startX,\n                      startY: this.touch.startY,\n                      time: this.touch.startTime\n                  };\n              }\n          }\n      }, {\n          key: '_move',\n          value: function _move() {}\n      }, {\n          key: '_end',\n          value: function _end() {\n              this.longTapTimeout && clearTimeout(this.longTapTimeout);\n          }\n      }, {\n          key: '_cancel',\n          value: function _cancel() {\n              console.log('cancle');\n          }\n      }, {\n          key: '_emit',\n          value: function _emit(type, e) {\n              !this.handles[type] && (this.handles[type] = []);\n              var currentTarget = $().isTarget(this.e, this.selector);\n              if (currentTarget || !this.selector) {\n                  this.selector && (this.params.selector = currentTarget);\n                  for (var i = 0, len = this.handles[type].length; i < len; i++) {\n                      typeof this.handles[type][i] === 'function' && this.handles[type][i](e, this.params);\n                  }\n              }\n              return true;\n          }\n      }, {\n          key: 'on',\n          value: function on(type, callback) {\n              !this.handles[type] && (this.handles[type] = []);\n              this.handles[type].push(callback);\n              return this;\n          }\n      }, {\n          key: '_init',\n          value: function _init() {\n              this.touch = {};\n              this.movetouch = {};\n              this.params = { zoom: 1, deltaX: 0, deltaY: 0, diffX: 0, diffY: 0, angle: 0, direction: '' };\n          }\n      }]);\n      return Gesture;\n  }();\n\n  try {\n      document;\n  } catch (ex) {\n      throw new Error('请在浏览器环境下运行');\n  }\n\n  var inlinecss = 'body{    width: 100%;    height: 100vh;    background: #f7c695;}div{    width: 100px;    height: 100px;    border-radius: 100%;    background: #fff;}';\n  var style = document.createElement('style');\n  style.type = 'text/css';\n  style.innerHTML = inlinecss;\n  document.getElementsByTagName('HEAD').item(0).appendChild(style);\n\n  var gesture = window.Gesture || Gesture;\n\n  return gesture;\n\n})));\n"]}